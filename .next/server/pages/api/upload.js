"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/upload";
exports.ids = ["pages/api/upload"];
exports.modules = {

/***/ "formidable-serverless":
/*!****************************************!*\
  !*** external "formidable-serverless" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("formidable-serverless");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = import("uuid");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupload.js&middlewareConfigBase64=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupload.js&middlewareConfigBase64=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\upload.js */ \"(api)/./pages/api/upload.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/upload\",\n        pathname: \"/api/upload\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_upload_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRnVwbG9hZCZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTVDYXBpJTVDdXBsb2FkLmpzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ29EO0FBQ3BEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxpREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsaURBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVELHFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vdmlkZW8tZHViYmVyLz8zODc4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcdXBsb2FkLmpzXCI7XG4vLyBSZS1leHBvcnQgdGhlIGhhbmRsZXIgKHNob3VsZCBiZSB0aGUgZGVmYXVsdCBleHBvcnQpLlxuZXhwb3J0IGRlZmF1bHQgaG9pc3QodXNlcmxhbmQsIFwiZGVmYXVsdFwiKTtcbi8vIFJlLWV4cG9ydCBjb25maWcuXG5leHBvcnQgY29uc3QgY29uZmlnID0gaG9pc3QodXNlcmxhbmQsIFwiY29uZmlnXCIpO1xuLy8gQ3JlYXRlIGFuZCBleHBvcnQgdGhlIHJvdXRlIG1vZHVsZSB0aGF0IHdpbGwgYmUgY29uc3VtZWQuXG5leHBvcnQgY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgUGFnZXNBUElSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuUEFHRVNfQVBJLFxuICAgICAgICBwYWdlOiBcIi9hcGkvdXBsb2FkXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvdXBsb2FkXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupload.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/upload.js":
/*!*****************************!*\
  !*** ./pages/api/upload.js ***!
  \*****************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var formidable_serverless__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! formidable-serverless */ \"formidable-serverless\");\n/* harmony import */ var formidable_serverless__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(formidable_serverless__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! uuid */ \"uuid\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([uuid__WEBPACK_IMPORTED_MODULE_3__]);\nuuid__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// pages/api/upload.js\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nasync function handler(req, res) {\n    console.log(\"\\uD83D\\uDE80 Upload API called\");\n    if (req.method !== \"POST\") {\n        console.log(\"❌ Method not POST\");\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    const form = new (formidable_serverless__WEBPACK_IMPORTED_MODULE_2___default().IncomingForm)();\n    form.uploadDir = path__WEBPACK_IMPORTED_MODULE_1___default().join(process.cwd(), \"temp_uploads\");\n    form.keepExtensions = true;\n    if (!fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(form.uploadDir)) {\n        fs__WEBPACK_IMPORTED_MODULE_0___default().mkdirSync(form.uploadDir, {\n            recursive: true\n        });\n        console.log(\"\\uD83D\\uDCC1 Created temp_uploads folder\");\n    }\n    console.log(\"⏳ Parsing form...\");\n    form.parse(req, async (err, fields, files)=>{\n        if (err) {\n            console.error(\"❌ Form parse error:\", err);\n            return res.status(500).json({\n                message: \"Upload error\"\n            });\n        }\n        console.log(\"\\uD83D\\uDCC4 Fields:\", fields);\n        console.log(\"\\uD83D\\uDCC2 Raw Files object:\", files); // <-- Debug log\n        const videoFile = files.video;\n        if (!videoFile) {\n            console.log(\"❌ No video file found in files object\");\n            return res.status(400).json({\n                message: \"No video file provided\"\n            });\n        }\n        // --- CRITICAL FIX ---\n        // Log the structure of the videoFile object to see what property holds the path\n        console.log(\"\\uD83D\\uDCC2 Video File Object:\", videoFile);\n        // `formidable` often stores the path in `path` or `filepath` or `file.path`\n        // For `formidable-serverless`, it's usually `path`\n        console.log(\"\\uD83D\\uDCC2 Video File Path (videoFile.path):\", videoFile.path);\n        console.log(\"\\uD83D\\uDCC2 Video File Path (videoFile.filepath):\", videoFile.filepath);\n        // Use the correct property - likely `path` for formidable-serverless\n        const originalPath = videoFile.path; // <-- Changed from videoFile.filepath\n        if (!originalPath) {\n            console.log(\"❌ Original path is undefined or empty:\", {\n                path: videoFile.path,\n                filepath: videoFile.filepath\n            });\n            return res.status(500).json({\n                message: \"File path error\"\n            });\n        }\n        // --- END FIX ---\n        const videoId = (0,uuid__WEBPACK_IMPORTED_MODULE_3__.v4)();\n        // Extract file extension from original name\n        const fileExtension = path__WEBPACK_IMPORTED_MODULE_1___default().extname(videoFile.name || videoFile.originalFilename || \"\").toLowerCase();\n        const newPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(form.uploadDir, `${videoId}${fileExtension}`);\n        try {\n            console.log(`⏳ Renaming file: ${originalPath} -> ${newPath}`);\n            await fs__WEBPACK_IMPORTED_MODULE_0___default().promises.rename(originalPath, newPath);\n            console.log(\"✅ File renamed successfully\");\n            const metadata = {\n                id: videoId,\n                originalName: videoFile.originalFilename || videoFile.name,\n                size: videoFile.size,\n                sourceLang: fields.sourceLang || \"en\",\n                targetLang: fields.targetLang || \"es\",\n                status: \"uploaded\",\n                path: newPath,\n                timestamp: new Date().toISOString()\n            };\n            const metadataPath = path__WEBPACK_IMPORTED_MODULE_1___default().join(form.uploadDir, `${videoId}_metadata.json`);\n            await fs__WEBPACK_IMPORTED_MODULE_0___default().promises.writeFile(metadataPath, JSON.stringify(metadata));\n            console.log(\"✅ Metadata written\");\n            res.status(200).json({\n                message: \"Upload successful\",\n                videoId\n            });\n        } catch (error) {\n            console.error(\"❌ Error moving file or writing metadata:\", error);\n            // Attempt to clean up if rename failed\n            if (originalPath && fs__WEBPACK_IMPORTED_MODULE_0___default().existsSync(originalPath)) {\n                try {\n                    await fs__WEBPACK_IMPORTED_MODULE_0___default().promises.unlink(originalPath);\n                } catch (unlinkError) {\n                    console.error(\"Failed to clean up temporary file:\", unlinkError);\n                }\n            }\n            res.status(500).json({\n                message: \"Processing error\",\n                error: error.message\n            });\n        }\n    });\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvdXBsb2FkLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBLHNCQUFzQjtBQUNGO0FBQ0k7QUFDdUI7QUFDWDtBQUU3QixNQUFNSyxTQUFTO0lBQ3BCQyxLQUFLO1FBQ0hDLFlBQVk7SUFDZDtBQUNGLEVBQUU7QUFFYSxlQUFlQyxRQUFRQyxHQUFHLEVBQUVDLEdBQUc7SUFDNUNDLFFBQVFDLEdBQUcsQ0FBQztJQUVaLElBQUlILElBQUlJLE1BQU0sS0FBSyxRQUFRO1FBQ3pCRixRQUFRQyxHQUFHLENBQUM7UUFDWixPQUFPRixJQUFJSSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLFNBQVM7UUFBcUI7SUFDOUQ7SUFFQSxNQUFNQyxPQUFPLElBQUlmLDJFQUF1QjtJQUN4Q2UsS0FBS0UsU0FBUyxHQUFHbEIsZ0RBQVMsQ0FBQ29CLFFBQVFDLEdBQUcsSUFBSTtJQUMxQ0wsS0FBS00sY0FBYyxHQUFHO0lBRXRCLElBQUksQ0FBQ3ZCLG9EQUFhLENBQUNpQixLQUFLRSxTQUFTLEdBQUc7UUFDbENuQixtREFBWSxDQUFDaUIsS0FBS0UsU0FBUyxFQUFFO1lBQUVPLFdBQVc7UUFBSztRQUMvQ2YsUUFBUUMsR0FBRyxDQUFDO0lBQ2Q7SUFFQUQsUUFBUUMsR0FBRyxDQUFDO0lBRVpLLEtBQUtVLEtBQUssQ0FBQ2xCLEtBQUssT0FBT21CLEtBQUtDLFFBQVFDO1FBQ2xDLElBQUlGLEtBQUs7WUFDUGpCLFFBQVFvQixLQUFLLENBQUMsdUJBQXVCSDtZQUNyQyxPQUFPbEIsSUFBSUksTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsU0FBUztZQUFlO1FBQ3hEO1FBRUFMLFFBQVFDLEdBQUcsQ0FBQyx3QkFBY2lCO1FBQzFCbEIsUUFBUUMsR0FBRyxDQUFDLGtDQUF3QmtCLFFBQVEsZ0JBQWdCO1FBRTVELE1BQU1FLFlBQVlGLE1BQU1HLEtBQUs7UUFDN0IsSUFBSSxDQUFDRCxXQUFXO1lBQ2RyQixRQUFRQyxHQUFHLENBQUM7WUFDWixPQUFPRixJQUFJSSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxTQUFTO1lBQXlCO1FBQ2xFO1FBRUEsdUJBQXVCO1FBQ3ZCLGdGQUFnRjtRQUNoRkwsUUFBUUMsR0FBRyxDQUFDLG1DQUF5Qm9CO1FBQ3JDLDRFQUE0RTtRQUM1RSxtREFBbUQ7UUFDbkRyQixRQUFRQyxHQUFHLENBQUMsa0RBQXdDb0IsVUFBVS9CLElBQUk7UUFDbEVVLFFBQVFDLEdBQUcsQ0FBQyxzREFBNENvQixVQUFVRSxRQUFRO1FBRTFFLHFFQUFxRTtRQUNyRSxNQUFNQyxlQUFlSCxVQUFVL0IsSUFBSSxFQUFFLHNDQUFzQztRQUUzRSxJQUFJLENBQUNrQyxjQUFjO1lBQ2hCeEIsUUFBUUMsR0FBRyxDQUFDLDBDQUEwQztnQkFBRVgsTUFBTStCLFVBQVUvQixJQUFJO2dCQUFFaUMsVUFBVUYsVUFBVUUsUUFBUTtZQUFDO1lBQzNHLE9BQU94QixJQUFJSSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxTQUFTO1lBQWtCO1FBQzVEO1FBRUEsa0JBQWtCO1FBRWxCLE1BQU1vQixVQUFVaEMsd0NBQU1BO1FBQ3RCLDRDQUE0QztRQUM1QyxNQUFNaUMsZ0JBQWdCcEMsbURBQVksQ0FBQytCLFVBQVVPLElBQUksSUFBSVAsVUFBVVEsZ0JBQWdCLElBQUksSUFBSUMsV0FBVztRQUNsRyxNQUFNQyxVQUFVekMsZ0RBQVMsQ0FBQ2dCLEtBQUtFLFNBQVMsRUFBRSxDQUFDLEVBQUVpQixRQUFRLEVBQUVDLGNBQWMsQ0FBQztRQUV0RSxJQUFJO1lBQ0YxQixRQUFRQyxHQUFHLENBQUMsQ0FBQyxpQkFBaUIsRUFBRXVCLGFBQWEsSUFBSSxFQUFFTyxRQUFRLENBQUM7WUFDNUQsTUFBTTFDLGtEQUFXLENBQUM0QyxNQUFNLENBQUNULGNBQWNPO1lBQ3ZDL0IsUUFBUUMsR0FBRyxDQUFDO1lBRVosTUFBTWlDLFdBQVc7Z0JBQ2ZDLElBQUlWO2dCQUNKVyxjQUFjZixVQUFVUSxnQkFBZ0IsSUFBSVIsVUFBVU8sSUFBSTtnQkFDMURTLE1BQU1oQixVQUFVZ0IsSUFBSTtnQkFDcEJDLFlBQVlwQixPQUFPb0IsVUFBVSxJQUFJO2dCQUNqQ0MsWUFBWXJCLE9BQU9xQixVQUFVLElBQUk7Z0JBQ2pDcEMsUUFBUTtnQkFDUmIsTUFBTXlDO2dCQUNOUyxXQUFXLElBQUlDLE9BQU9DLFdBQVc7WUFDbkM7WUFFQSxNQUFNQyxlQUFlckQsZ0RBQVMsQ0FBQ2dCLEtBQUtFLFNBQVMsRUFBRSxDQUFDLEVBQUVpQixRQUFRLGNBQWMsQ0FBQztZQUN6RSxNQUFNcEMsa0RBQVcsQ0FBQ3VELFNBQVMsQ0FBQ0QsY0FBY0UsS0FBS0MsU0FBUyxDQUFDWjtZQUN6RGxDLFFBQVFDLEdBQUcsQ0FBQztZQUVaRixJQUFJSSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxTQUFTO2dCQUFxQm9CO1lBQVE7UUFFL0QsRUFBRSxPQUFPTCxPQUFPO1lBQ2RwQixRQUFRb0IsS0FBSyxDQUFDLDRDQUE0Q0E7WUFDMUQsdUNBQXVDO1lBQ3ZDLElBQUlJLGdCQUFnQm5DLG9EQUFhLENBQUNtQyxlQUFlO2dCQUMvQyxJQUFJO29CQUNGLE1BQU1uQyxrREFBVyxDQUFDMEQsTUFBTSxDQUFDdkI7Z0JBQzNCLEVBQUUsT0FBT3dCLGFBQWE7b0JBQ3BCaEQsUUFBUW9CLEtBQUssQ0FBQyxzQ0FBc0M0QjtnQkFDdEQ7WUFDRjtZQUNBakQsSUFBSUksTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztnQkFBRUMsU0FBUztnQkFBb0JlLE9BQU9BLE1BQU1mLE9BQU87WUFBQztRQUMzRTtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92aWRlby1kdWJiZXIvLi9wYWdlcy9hcGkvdXBsb2FkLmpzPzU1NzIiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gcGFnZXMvYXBpL3VwbG9hZC5qc1xyXG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcclxuaW1wb3J0IGZvcm1pZGFibGUgZnJvbSAnZm9ybWlkYWJsZS1zZXJ2ZXJsZXNzJztcclxuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSAndXVpZCc7XHJcblxyXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGFwaToge1xyXG4gICAgYm9keVBhcnNlcjogZmFsc2UsXHJcbiAgfSxcclxufTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxLCByZXMpIHtcclxuICBjb25zb2xlLmxvZygn8J+agCBVcGxvYWQgQVBJIGNhbGxlZCcpO1xyXG5cclxuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XHJcbiAgICBjb25zb2xlLmxvZygn4p2MIE1ldGhvZCBub3QgUE9TVCcpO1xyXG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgbWVzc2FnZTogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBmb3JtID0gbmV3IGZvcm1pZGFibGUuSW5jb21pbmdGb3JtKCk7XHJcbiAgZm9ybS51cGxvYWREaXIgPSBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3RlbXBfdXBsb2FkcycpO1xyXG4gIGZvcm0ua2VlcEV4dGVuc2lvbnMgPSB0cnVlO1xyXG5cclxuICBpZiAoIWZzLmV4aXN0c1N5bmMoZm9ybS51cGxvYWREaXIpKSB7XHJcbiAgICBmcy5ta2RpclN5bmMoZm9ybS51cGxvYWREaXIsIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xyXG4gICAgY29uc29sZS5sb2coJ/Cfk4EgQ3JlYXRlZCB0ZW1wX3VwbG9hZHMgZm9sZGVyJyk7XHJcbiAgfVxyXG5cclxuICBjb25zb2xlLmxvZygn4o+zIFBhcnNpbmcgZm9ybS4uLicpO1xyXG5cclxuICBmb3JtLnBhcnNlKHJlcSwgYXN5bmMgKGVyciwgZmllbGRzLCBmaWxlcykgPT4ge1xyXG4gICAgaWYgKGVycikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRm9ybSBwYXJzZSBlcnJvcjonLCBlcnIpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBtZXNzYWdlOiAnVXBsb2FkIGVycm9yJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zb2xlLmxvZygn8J+ThCBGaWVsZHM6JywgZmllbGRzKTtcclxuICAgIGNvbnNvbGUubG9nKCfwn5OCIFJhdyBGaWxlcyBvYmplY3Q6JywgZmlsZXMpOyAvLyA8LS0gRGVidWcgbG9nXHJcblxyXG4gICAgY29uc3QgdmlkZW9GaWxlID0gZmlsZXMudmlkZW87XHJcbiAgICBpZiAoIXZpZGVvRmlsZSkge1xyXG4gICAgICBjb25zb2xlLmxvZygn4p2MIE5vIHZpZGVvIGZpbGUgZm91bmQgaW4gZmlsZXMgb2JqZWN0Jyk7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICdObyB2aWRlbyBmaWxlIHByb3ZpZGVkJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyAtLS0gQ1JJVElDQUwgRklYIC0tLVxyXG4gICAgLy8gTG9nIHRoZSBzdHJ1Y3R1cmUgb2YgdGhlIHZpZGVvRmlsZSBvYmplY3QgdG8gc2VlIHdoYXQgcHJvcGVydHkgaG9sZHMgdGhlIHBhdGhcclxuICAgIGNvbnNvbGUubG9nKCfwn5OCIFZpZGVvIEZpbGUgT2JqZWN0OicsIHZpZGVvRmlsZSk7XHJcbiAgICAvLyBgZm9ybWlkYWJsZWAgb2Z0ZW4gc3RvcmVzIHRoZSBwYXRoIGluIGBwYXRoYCBvciBgZmlsZXBhdGhgIG9yIGBmaWxlLnBhdGhgXHJcbiAgICAvLyBGb3IgYGZvcm1pZGFibGUtc2VydmVybGVzc2AsIGl0J3MgdXN1YWxseSBgcGF0aGBcclxuICAgIGNvbnNvbGUubG9nKCfwn5OCIFZpZGVvIEZpbGUgUGF0aCAodmlkZW9GaWxlLnBhdGgpOicsIHZpZGVvRmlsZS5wYXRoKTtcclxuICAgIGNvbnNvbGUubG9nKCfwn5OCIFZpZGVvIEZpbGUgUGF0aCAodmlkZW9GaWxlLmZpbGVwYXRoKTonLCB2aWRlb0ZpbGUuZmlsZXBhdGgpO1xyXG5cclxuICAgIC8vIFVzZSB0aGUgY29ycmVjdCBwcm9wZXJ0eSAtIGxpa2VseSBgcGF0aGAgZm9yIGZvcm1pZGFibGUtc2VydmVybGVzc1xyXG4gICAgY29uc3Qgb3JpZ2luYWxQYXRoID0gdmlkZW9GaWxlLnBhdGg7IC8vIDwtLSBDaGFuZ2VkIGZyb20gdmlkZW9GaWxlLmZpbGVwYXRoXHJcblxyXG4gICAgaWYgKCFvcmlnaW5hbFBhdGgpIHtcclxuICAgICAgIGNvbnNvbGUubG9nKCfinYwgT3JpZ2luYWwgcGF0aCBpcyB1bmRlZmluZWQgb3IgZW1wdHk6JywgeyBwYXRoOiB2aWRlb0ZpbGUucGF0aCwgZmlsZXBhdGg6IHZpZGVvRmlsZS5maWxlcGF0aCB9KTtcclxuICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdGaWxlIHBhdGggZXJyb3InIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIC0tLSBFTkQgRklYIC0tLVxyXG5cclxuICAgIGNvbnN0IHZpZGVvSWQgPSB1dWlkdjQoKTtcclxuICAgIC8vIEV4dHJhY3QgZmlsZSBleHRlbnNpb24gZnJvbSBvcmlnaW5hbCBuYW1lXHJcbiAgICBjb25zdCBmaWxlRXh0ZW5zaW9uID0gcGF0aC5leHRuYW1lKHZpZGVvRmlsZS5uYW1lIHx8IHZpZGVvRmlsZS5vcmlnaW5hbEZpbGVuYW1lIHx8ICcnKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgY29uc3QgbmV3UGF0aCA9IHBhdGguam9pbihmb3JtLnVwbG9hZERpciwgYCR7dmlkZW9JZH0ke2ZpbGVFeHRlbnNpb259YCk7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc29sZS5sb2coYOKPsyBSZW5hbWluZyBmaWxlOiAke29yaWdpbmFsUGF0aH0gLT4gJHtuZXdQYXRofWApO1xyXG4gICAgICBhd2FpdCBmcy5wcm9taXNlcy5yZW5hbWUob3JpZ2luYWxQYXRoLCBuZXdQYXRoKTtcclxuICAgICAgY29uc29sZS5sb2coJ+KchSBGaWxlIHJlbmFtZWQgc3VjY2Vzc2Z1bGx5Jyk7XHJcblxyXG4gICAgICBjb25zdCBtZXRhZGF0YSA9IHtcclxuICAgICAgICBpZDogdmlkZW9JZCxcclxuICAgICAgICBvcmlnaW5hbE5hbWU6IHZpZGVvRmlsZS5vcmlnaW5hbEZpbGVuYW1lIHx8IHZpZGVvRmlsZS5uYW1lLFxyXG4gICAgICAgIHNpemU6IHZpZGVvRmlsZS5zaXplLFxyXG4gICAgICAgIHNvdXJjZUxhbmc6IGZpZWxkcy5zb3VyY2VMYW5nIHx8ICdlbicsXHJcbiAgICAgICAgdGFyZ2V0TGFuZzogZmllbGRzLnRhcmdldExhbmcgfHwgJ2VzJyxcclxuICAgICAgICBzdGF0dXM6ICd1cGxvYWRlZCcsXHJcbiAgICAgICAgcGF0aDogbmV3UGF0aCxcclxuICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgbWV0YWRhdGFQYXRoID0gcGF0aC5qb2luKGZvcm0udXBsb2FkRGlyLCBgJHt2aWRlb0lkfV9tZXRhZGF0YS5qc29uYCk7XHJcbiAgICAgIGF3YWl0IGZzLnByb21pc2VzLndyaXRlRmlsZShtZXRhZGF0YVBhdGgsIEpTT04uc3RyaW5naWZ5KG1ldGFkYXRhKSk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgTWV0YWRhdGEgd3JpdHRlbicpO1xyXG5cclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBtZXNzYWdlOiAnVXBsb2FkIHN1Y2Nlc3NmdWwnLCB2aWRlb0lkIH0pO1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBFcnJvciBtb3ZpbmcgZmlsZSBvciB3cml0aW5nIG1ldGFkYXRhOicsIGVycm9yKTtcclxuICAgICAgLy8gQXR0ZW1wdCB0byBjbGVhbiB1cCBpZiByZW5hbWUgZmFpbGVkXHJcbiAgICAgIGlmIChvcmlnaW5hbFBhdGggJiYgZnMuZXhpc3RzU3luYyhvcmlnaW5hbFBhdGgpKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgIGF3YWl0IGZzLnByb21pc2VzLnVubGluayhvcmlnaW5hbFBhdGgpO1xyXG4gICAgICAgIH0gY2F0Y2ggKHVubGlua0Vycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY2xlYW4gdXAgdGVtcG9yYXJ5IGZpbGU6JywgdW5saW5rRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6ICdQcm9jZXNzaW5nIGVycm9yJywgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn0iXSwibmFtZXMiOlsiZnMiLCJwYXRoIiwiZm9ybWlkYWJsZSIsInY0IiwidXVpZHY0IiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJjb25zb2xlIiwibG9nIiwibWV0aG9kIiwic3RhdHVzIiwianNvbiIsIm1lc3NhZ2UiLCJmb3JtIiwiSW5jb21pbmdGb3JtIiwidXBsb2FkRGlyIiwiam9pbiIsInByb2Nlc3MiLCJjd2QiLCJrZWVwRXh0ZW5zaW9ucyIsImV4aXN0c1N5bmMiLCJta2RpclN5bmMiLCJyZWN1cnNpdmUiLCJwYXJzZSIsImVyciIsImZpZWxkcyIsImZpbGVzIiwiZXJyb3IiLCJ2aWRlb0ZpbGUiLCJ2aWRlbyIsImZpbGVwYXRoIiwib3JpZ2luYWxQYXRoIiwidmlkZW9JZCIsImZpbGVFeHRlbnNpb24iLCJleHRuYW1lIiwibmFtZSIsIm9yaWdpbmFsRmlsZW5hbWUiLCJ0b0xvd2VyQ2FzZSIsIm5ld1BhdGgiLCJwcm9taXNlcyIsInJlbmFtZSIsIm1ldGFkYXRhIiwiaWQiLCJvcmlnaW5hbE5hbWUiLCJzaXplIiwic291cmNlTGFuZyIsInRhcmdldExhbmciLCJ0aW1lc3RhbXAiLCJEYXRlIiwidG9JU09TdHJpbmciLCJtZXRhZGF0YVBhdGgiLCJ3cml0ZUZpbGUiLCJKU09OIiwic3RyaW5naWZ5IiwidW5saW5rIiwidW5saW5rRXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/upload.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fupload&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cupload.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();